
#!/bin/bash

LOGFILE=log/selectInotify

INIFILE=${1}inotify.desc

if [ -f $INIFILE ]
then
. $INIFILE 
else
echo Unable to Init $0
exit 0
fi 

#extract extention of file 
FILE=$2
echo FILE ${1}$FILE >> $LOGFILE
EXT=$(echo $FILE | cut -d . -f2)
 
grep -q ${EXT}= $INIFILE

if [ $? -ne 0 ]
then
echo ${1} UNDEFINE COMMAND $EXT >> $LOGFILE
DIRNAME=nok/UNKNOWNCOMMAND/${1}
mkdir -p $DIRNAME
mv ${1}$FILE $DIRNAME
exit 0
fi

COMMAND=$(grep ${EXT}= $INIFILE | cut -d= -f2)


if [ ! -f $COMMAND ]
then
echo ${1} NON EXISTING COMMAND $COMMAND >> $LOGFILE
DIRNAME=nok/NOEXISTCOMMAND/${1}
mkdir -p $DIRNAME
mv ${1}$FILE $DIRNAME
exit 0
	
fi

$COMMAND $1 $2
